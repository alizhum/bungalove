const header = document.getElementById('header');
const headerMobile = document.getElementById('header-mobile');
const navToggle = document.getElementById('nav-toggle');

new WOW().init();
tabsInit();
modalInit();

navToggle.addEventListener('click', function() {

  header.classList.toggle('header--nav-active');
  this.classList.toggle('nav-toggle--active');
  headerMobile.classList.toggle('header__mobile--active');
  document.body.classList.toggle('overflow-hidden');

});

// Tabs
function tabsInit() {

  const tabButtons = document.querySelectorAll('.tab__button');

  tabButtons?.forEach(function(button) {

    button.addEventListener('click', function() {
  
      if( this.classList.contains('tab__button--active') ) return;
  
      const tab = this.closest('.tab');
      const contentID = this.dataset.content;
      const activeContent = tab.querySelector('.tab__content--active');
      const activeButton = tab.querySelector('.tab__button--active');
      const contentToActive = document.getElementById(contentID);
      
  
      if( contentToActive ) {
  
        activeContent.classList.remove('tab__content--active');
        activeButton.classList.remove('tab__button--active');
  
        this.classList.add('tab__button--active');
        contentToActive.classList.add('tab__content--active');
  
      }
  
    });
  });
}

// Modal
function modalInit() {

  const openModal = document.querySelectorAll('.open-modal');
  const modalClose = document.querySelectorAll('.modal__close');

  if( openModal ) {

    openModal.forEach(function(button) {
      button.addEventListener('click', function(e) {
        console.log(button)
        e.preventDefault();
        const modalId = button.dataset.id;
    
        const modal = document.getElementById(modalId);
  
        if( modal ) {
  
          document.body.classList.add('overflow-hidden');
          modal.classList.add('modal--active');
  
          if( button.dataset.id == 'mentor-preview' ) {
            const card = button.closest('.mentor-card');
            if (card) {
                fillMentorPreviewModal(card);
            }
          }
  
        }
  
      });
    });
  
  }
  
  if( modalClose ) {
  
    modalClose.forEach(function(button) {
      button.addEventListener('click', function() {
        this.closest('.modal').classList.remove('modal--active');
        if( !document.querySelector('.modal--active') ) {
          document.body.classList.remove('overflow-hidden');
        }
      });
    });
  
  }

}

// Events
document.addEventListener('click', function(e) {

  if(e.target.classList.contains('modal')) {
    const modalToClose = document.querySelector('.modal--active');
    if( modalToClose ) {
      modalToClose.classList.remove('modal--active');
    }
    if( !document.querySelector('.modal--active') ) {
      document.body.classList.remove('overflow-hidden');
    }
  }
});

// Sliders

const apartmentsSlider = new Swiper('.apartments__slider', {
  slidesPerView: 1,
  spaceBetween: 27,
  navigation: {
    prevEl: '.apartments__nav-button--prev',
    nextEl: '.apartments__nav-button--next'
  },
  breakpoints: {
    0: {
      spaceBetween: 10
    },
    576: {
      slidesPerView: 2,
      spaceBetween: 20
    },
    800: {
      slidesPerView: 3,
      spaceBetween: 20
    },
    1170: {
      slidesPerView: 4,
    }
  }
});